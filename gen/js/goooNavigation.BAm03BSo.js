import{s as L}from"./reactivity.esm-bundler.BjcA3cuu.js";const U=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,D=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,Q=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function J(e,t){if(e==="__proto__"||e==="constructor"&&t&&typeof t=="object"&&"prototype"in t){B(e);return}return t}function B(e){console.warn(`[destr] Dropping "${e}" key to prevent prototype pollution.`)}function G(e,t={}){if(typeof e!="string")return e;if(e[0]==='"'&&e[e.length-1]==='"'&&e.indexOf("\\")===-1)return e.slice(1,-1);const r=e.trim();if(r.length<=9)switch(r.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!Q.test(e)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return e}try{if(U.test(e)||D.test(e)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(e,J)}return JSON.parse(e)}catch(n){if(t.strict)throw n;return e}}const K=/#/g,k=/&/g,z=/\//g,V=/=/g,T=/\+/g,W=/%5e/gi,X=/%60/gi,Y=/%7c/gi,Z=/%20/gi;function x(e){return encodeURI(""+e).replace(Y,"|")}function b(e){return x(typeof e=="string"?e:JSON.stringify(e)).replace(T,"%2B").replace(Z,"+").replace(K,"%23").replace(k,"%26").replace(X,"`").replace(W,"^").replace(z,"%2F")}function E(e){return b(e).replace(V,"%3D")}function q(e=""){try{return decodeURIComponent(""+e)}catch{return""+e}}function ee(e){return q(e.replace(T," "))}function te(e){return q(e.replace(T," "))}function oe(e=""){const t=Object.create(null);e[0]==="?"&&(e=e.slice(1));for(const r of e.split("&")){const n=r.match(/([^=]+)=?(.*)/)||[];if(n.length<2)continue;const s=ee(n[1]);if(s==="__proto__"||s==="constructor")continue;const a=te(n[2]||"");t[s]===void 0?t[s]=a:Array.isArray(t[s])?t[s].push(a):t[s]=[t[s],a]}return t}function re(e,t){return(typeof t=="number"||typeof t=="boolean")&&(t=String(t)),t?Array.isArray(t)?t.map(r=>`${E(e)}=${b(r)}`).join("&"):`${E(e)}=${b(t)}`:E(e)}function ne(e){return Object.keys(e).filter(t=>e[t]!==void 0).map(t=>re(t,e[t])).filter(Boolean).join("&")}const se=/^[\s\w\0+.-]{2,}:([/\\]{1,2})/,ie=/^[\s\w\0+.-]{2,}:([/\\]{2})?/,ae=/^([/\\]\s*){2,}[^/\\]/,ce=/^\.?\//;function O(e,t={}){return typeof t=="boolean"&&(t={acceptRelative:t}),t.strict?se.test(e):ie.test(e)||(t.acceptRelative?ae.test(e):!1)}function ue(e="",t){return e.endsWith("/")}function pe(e="",t){return(ue(e)?e.slice(0,-1):e)||"/"}function fe(e="",t){return e.endsWith("/")?e:e+"/"}function le(e,t){if(ye(t)||O(e))return e;const r=pe(t);return e.startsWith(r)?e:me(r,e)}function he(e,t){const r=ge(e),n={...oe(r.search),...t};return r.search=ne(n),we(r)}function ye(e){return!e||e==="/"}function de(e){return e&&e!=="/"}function me(e,...t){let r=e||"";for(const n of t.filter(s=>de(s)))if(r){const s=n.replace(ce,"");r=fe(r)+s}else r=n;return r}const I=Symbol.for("ufo:protocolRelative");function ge(e="",t){const r=e.match(/^[\s\0]*(blob:|data:|javascript:|vbscript:)(.*)/i);if(r){const[,f,h=""]=r;return{protocol:f.toLowerCase(),pathname:h,href:f+h,auth:"",host:"",search:"",hash:""}}if(!O(e,{acceptRelative:!0}))return _(e);const[,n="",s,a=""]=e.replace(/\\/g,"/").match(/^[\s\0]*([\w+.-]{2,}:)?\/\/([^/@]+@)?(.*)/)||[];let[,c="",i=""]=a.match(/([^#/?]*)(.*)?/)||[];n==="file:"&&(i=i.replace(/\/(?=[A-Za-z]:)/,""));const{pathname:u,search:l,hash:o}=_(i);return{protocol:n.toLowerCase(),auth:s?s.slice(0,Math.max(0,s.length-1)):"",host:c,pathname:u,search:l,hash:o,[I]:!n}}function _(e=""){const[t="",r="",n=""]=(e.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:t,search:r,hash:n}}function we(e){const t=e.pathname||"",r=e.search?(e.search.startsWith("?")?"":"?")+e.search:"",n=e.hash||"",s=e.auth?e.auth+"@":"",a=e.host||"";return(e.protocol||e[I]?(e.protocol||"")+"//":"")+s+a+t+r+n}class Ee extends Error{constructor(t,r){super(t,r),this.name="FetchError",r!=null&&r.cause&&!this.cause&&(this.cause=r.cause)}}function be(e){var u,l,o,f,h;const t=((u=e.error)==null?void 0:u.message)||((l=e.error)==null?void 0:l.toString())||"",r=((o=e.request)==null?void 0:o.method)||((f=e.options)==null?void 0:f.method)||"GET",n=((h=e.request)==null?void 0:h.url)||String(e.request)||"/",s=`[${r}] ${JSON.stringify(n)}`,a=e.response?`${e.response.status} ${e.response.statusText}`:"<no response>",c=`${s}: ${a}${t?` ${t}`:""}`,i=new Ee(c,e.error?{cause:e.error}:void 0);for(const p of["request","options","response"])Object.defineProperty(i,p,{get(){return e[p]}});for(const[p,d]of[["data","_data"],["status","status"],["statusCode","status"],["statusText","statusText"],["statusMessage","statusText"]])Object.defineProperty(i,p,{get(){return e.response&&e.response[d]}});return i}const Re=new Set(Object.freeze(["PATCH","POST","PUT","DELETE"]));function C(e="GET"){return Re.has(e.toUpperCase())}function Se(e){if(e===void 0)return!1;const t=typeof e;return t==="string"||t==="number"||t==="boolean"||t===null?!0:t!=="object"?!1:Array.isArray(e)?!0:e.buffer?!1:e.constructor&&e.constructor.name==="Object"||typeof e.toJSON=="function"}const Te=new Set(["image/svg","application/xml","application/xhtml","application/html"]),Ae=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function _e(e=""){if(!e)return"json";const t=e.split(";").shift()||"";return Ae.test(t)?"json":Te.has(t)||t.startsWith("text/")?"text":"blob"}function Ce(e,t,r,n){const s=Ne((t==null?void 0:t.headers)??(e==null?void 0:e.headers),r==null?void 0:r.headers,n);let a;return(r!=null&&r.query||r!=null&&r.params||t!=null&&t.params||t!=null&&t.query)&&(a={...r==null?void 0:r.params,...r==null?void 0:r.query,...t==null?void 0:t.params,...t==null?void 0:t.query}),{...r,...t,query:a,params:a,headers:s}}function Ne(e,t,r){if(!t)return new r(e);const n=new r(t);if(e)for(const[s,a]of Symbol.iterator in e||Array.isArray(e)?e:new r(e))n.set(s,a);return n}async function g(e,t){if(t)if(Array.isArray(t))for(const r of t)await r(e);else await t(e)}const Pe=new Set([408,409,425,429,500,502,503,504]),Le=new Set([101,204,205,304]);function j(e={}){const{fetch:t=globalThis.fetch,Headers:r=globalThis.Headers,AbortController:n=globalThis.AbortController}=e;async function s(i){const u=i.error&&i.error.name==="AbortError"&&!i.options.timeout||!1;if(i.options.retry!==!1&&!u){let o;typeof i.options.retry=="number"?o=i.options.retry:o=C(i.options.method)?0:1;const f=i.response&&i.response.status||500;if(o>0&&(Array.isArray(i.options.retryStatusCodes)?i.options.retryStatusCodes.includes(f):Pe.has(f))){const h=typeof i.options.retryDelay=="function"?i.options.retryDelay(i):i.options.retryDelay||0;return h>0&&await new Promise(p=>setTimeout(p,h)),a(i.request,{...i.options,retry:o-1})}}const l=be(i);throw Error.captureStackTrace&&Error.captureStackTrace(l,a),l}const a=async function(u,l={}){const o={request:u,options:Ce(u,l,e.defaults,r),response:void 0,error:void 0};o.options.method&&(o.options.method=o.options.method.toUpperCase()),o.options.onRequest&&await g(o,o.options.onRequest),typeof o.request=="string"&&(o.options.baseURL&&(o.request=le(o.request,o.options.baseURL)),o.options.query&&(o.request=he(o.request,o.options.query),delete o.options.query),"query"in o.options&&delete o.options.query,"params"in o.options&&delete o.options.params),o.options.body&&C(o.options.method)&&(Se(o.options.body)?(o.options.body=typeof o.options.body=="string"?o.options.body:JSON.stringify(o.options.body),o.options.headers=new r(o.options.headers||{}),o.options.headers.has("content-type")||o.options.headers.set("content-type","application/json"),o.options.headers.has("accept")||o.options.headers.set("accept","application/json")):("pipeTo"in o.options.body&&typeof o.options.body.pipeTo=="function"||typeof o.options.body.pipe=="function")&&("duplex"in o.options||(o.options.duplex="half")));let f;if(!o.options.signal&&o.options.timeout){const p=new n;f=setTimeout(()=>{const d=new Error("[TimeoutError]: The operation was aborted due to timeout");d.name="TimeoutError",d.code=23,p.abort(d)},o.options.timeout),o.options.signal=p.signal}try{o.response=await t(o.request,o.options)}catch(p){return o.error=p,o.options.onRequestError&&await g(o,o.options.onRequestError),await s(o)}finally{f&&clearTimeout(f)}if((o.response.body||o.response._bodyInit)&&!Le.has(o.response.status)&&o.options.method!=="HEAD"){const p=(o.options.parseResponse?"json":o.options.responseType)||_e(o.response.headers.get("content-type")||"");switch(p){case"json":{const d=await o.response.text(),H=o.options.parseResponse||G;o.response._data=H(d);break}case"stream":{o.response._data=o.response.body||o.response._bodyInit;break}default:o.response._data=await o.response[p]()}}return o.options.onResponse&&await g(o,o.options.onResponse),!o.options.ignoreResponseError&&o.response.status>=400&&o.response.status<600?(o.options.onResponseError&&await g(o,o.options.onResponseError),await s(o)):o.response},c=async function(u,l){return(await a(u,l))._data};return c.raw=a,c.native=(...i)=>t(...i),c.create=(i={},u={})=>j({...e,...u,defaults:{...e.defaults,...u.defaults,...i}}),c}const w=function(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}(),qe=w.fetch?(...e)=>w.fetch(...e):()=>Promise.reject(new Error("[ofetch] global.fetch is not supported!")),Oe=w.Headers,Ie=w.AbortController,je=j({fetch:qe,Headers:Oe,AbortController:Ie}),$e=je;window.fileRegistry??(window.fileRegistry=new Map);const m=new Set,y=L("idle"),R=L(window.location.pathname);let N=!1;const A=e=>$e(e,{method:"GET",headers:{Accept:"text/html"},onRequest:()=>{y.value="pending"},onResponse:({response:t})=>{y.value=t.ok?"success":"error"},onResponseError:()=>{y.value="error"}}),$=e=>{const t=document.createElement("script");return t.setAttribute("data-page-script","true"),t.type=e.type||"text/javascript",t.async=!1,e.src?t.src=e.src:t.textContent=e.textContent,t},ve=e=>{document.querySelectorAll("script[data-page-script]").forEach(t=>t.remove()),e.querySelectorAll("script[data-page-script]").forEach(t=>{const r=t,n=r.getAttribute("data-vite-input");(!r.src||!m.has(n))&&(n&&m.add(n),document.body.appendChild($(r)))})},v=async e=>{e.querySelectorAll("script[data-page-script]").forEach(t=>{var a,c;const r=t,n=r.getAttribute("data-vite-input"),s=(a=window.fileRegistry)==null?void 0:a.get(n);r.src&&m.has(n)&&(s!=null&&s.hydrate)?(s.unMount&&s.unMount(),s.hydrate(),r.remove()):(n&&m.add(n),(c=r.parentNode)==null||c.replaceChild($(r),r))})},F=e=>new DOMParser().parseFromString(e,"text/html"),M=(e,t=!0,r="")=>{const n=e.querySelector("[gooo-layout]"),s=document.querySelector("[gooo-layout]");if(!n)return console.error("Missing [gooo-layout] in new document"),console.error(e.documentElement.outerHTML),y.value="error",location.href=r,!1;const a=n.getAttribute("gooo-layout"),c=s==null?void 0:s.getAttribute("gooo-layout");if(s&&a===c)return s.innerHTML=n.innerHTML,t&&history.pushState({url:r},e.title??document.title,r),R.value=r,s;{const i=e.body.innerHTML;return document.body.innerHTML=i,t&&history.pushState({url:r},e.title??document.title,r),R.value=r,document.body}},S=new Map,He=async e=>{if(!S.has(e))try{const t=await A(e);S.set(e,t)}catch(t){console.warn(`Prefetch failed for ${e}`,t)}},Ue=async e=>{try{const t=S.get(e),n=t!==void 0?t:await A(e),s=F(n);if(!M(s,!0,e))return;v(document.documentElement),ve(s),y.value="success"}catch(t){console.error("Navigation error:",t),y.value="error",location.href=e}},P=async()=>{const e=location.pathname;if(e!==R.value){y.value="pending";try{const t=await A(e),r=F(t),n=M(r,!1,e);if(!n)return;v(n),history.replaceState({url:e},r.title??document.title,e),y.value="success"}catch(t){console.error("Popstate error:",t),y.value="error",location.href=e}}},Fe=()=>{N||(N=!0,document.querySelectorAll("script[data-page-script]").forEach(e=>{const t=e.getAttribute("data-vite-input");m.add(t)}),addEventListener("popstate",P),addEventListener("unload",()=>removeEventListener("popstate",P)))};Fe();export{Ue as n,He as p};
